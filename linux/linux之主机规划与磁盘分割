linux之主机规划与磁盘分割

linux系统中，每个装置都被当成一个档案来对待。
裝置	                裝置在Linux內的檔名
SCSI/SATA/USB硬碟機	    /dev/sd[a-p]
USB快閃碟	            /dev/sd[a-p] (與SATA相同)
VirtI/O界面	            /dev/vd[a-p] (用於虛擬機器內)
軟碟機	                /dev/fd[0-1]
印表機	                /dev/lp[0-2] (25針印表機)
                        /dev/usb/lp[0-15] (USB 介面)
滑鼠	                /dev/input/mouse[0-15] (通用)
                        /dev/psaux (PS/2界面)
                        /dev/mouse (當前滑鼠)
CDROM/DVDROM	        /dev/scd[0-1] (通用)
                        /dev/sr[0-1] (通用，CentOS 較常見)
                        /dev/cdrom (當前 CDROM*)
磁帶機	                 /dev/ht0 (IDE 界面)
                        /dev/st0 (SATA/SCSI界面)
                        /dev/tape (當前磁帶)
IDE硬碟機	             /dev/hd[a-d] (舊式系統才有)

整個目錄樹架構最重要的就是那個根目錄(root directory)，這個根目錄的表示方法為一條斜線『/』， 所有的檔案都與目錄樹有關。

                /
                ↓
etc     bin     home        usr     ...
                ↓
     dmtsai  arod  damon  wong
        ↓
.bashrc  .profile  mydata  desktop

那當我們想要取得mydata那個檔案時，系統就得由根目錄開始找，然後找到home接下來找到dmtsai， 最終的檔名為：/home/dmtsai/mydata的意思。

檔案系統與目錄樹的關係(掛載)
所謂的『掛載』就是利用一個目錄當成進入點，將磁碟分割槽的資料放置在該目錄下； 也就是說，進入該目錄就可以讀取該分割槽的意思。

這個動作我們稱為『掛載』，那個進入點的目錄我們稱為『掛載點』。 由於整個Linux系統最重要的是根目錄，因此根目錄一定需要掛載到某個分割槽的。 至於其他的目錄則可依使用者自己的需求來給予掛載到不同的分割槽。

partition1 ← / → etc
               → dev
               → bin
               → ...
partition2 ←   → home → vbird → test
                    → dmtsai
上圖中假設我的硬碟分為兩槽，partition 1是掛載到根目錄，至於partition 2則是掛載到/home這個目錄。 這也就是說，當我的資料放置在/home內的各次目錄時，資料是放置到partition 2的，如果不是放在/home底下的目錄， 那麼資料就會被放置到partition 1了！

distributions安裝時，掛載點與磁碟分割的規劃：
自訂安裝『Custom』：

A：初次接觸Linux：只要分割『 / 』及『swap』即可：
通常初次安裝Linux系統的朋友們，我們都會建議他直接以一個最大的分割槽『 / 』來安裝系統。 這樣作有個好處，就是不怕分割錯誤造成無法安裝的困境！例如/usr是Linux的可執行程式及相關的文件擺放的目錄， 所以他的容量需求蠻大的，萬一你分割了一塊分割槽給/usr，但是卻給的不夠大，那麼就傷腦筋了！ 因為會造成無法將資料完全寫入的問題，就有可能會無法安裝啦！因此如果你是初次安裝的話， 那麼可以僅分割成兩個分割槽『 / 與 Swap 』即可。

B：建議分割的方法：預留一個備用的剩餘磁碟容量！
在想要學習Linux的朋友中，最麻煩的可能就是得要常常處理分割的問題，因為分割是系統管理員很重要的一個任務。 但如果你將整個硬碟的容量都用光了，那麼你要如何練習分割呢？^_^。所以鳥哥在後續的練習中也會這樣做， 就是請你特別預留一塊不分割的磁碟容量，作為後續練習時可以用來分割之用！

此外，預留的分割槽也可以拿來做為備份之用。因為我們在實際操作Linux系統的過程中， 可能會發現某些script或者是重要的檔案很值得備份時，就可以使用這個剩餘的容量分割出新的分割槽， 並使用來備份重要的設定檔或者是script。這有個最大的好處， 就是當我的Linux重新安裝的時候，我的一些軟體或工具程式馬上就可以直接在硬碟當中找到！呵呵！重新安裝比較便利啦。 為什麼要重新安裝？因為沒有安裝過Linux十次以上，不要說你學會了Linux了啦！慢慢體會這句話吧！

主機的服務規劃與硬體的關係
NAT(達成IP分享器的功能)：
通常小型企業或者是學校單位大多僅會有一條對外的連線，然後全公司/學校內的電腦全部透過這條連線連到網際網路上。 此時我們就得要使用IP分享器來讓這一條對外連線分享給所有的公司內部員工使用。 那麼Linux能不能達到此一IP分享的功能呢？當然可以，就是透過NAT服務即可達成這項任務了！

在這種環境中，由於Linux作為一個內/外分離的實體，因此網路流量會比較大一點。 此時Linux主機的網路卡就需要比較好些的配備。其他的CPU、RAM、硬碟等等的影響就小很多。 事實上，單利用Linux作為NAT主機來分享IP是很不智的～因為PC的耗電能力比IP分享器要大的多～

那麼為什麼你還要使用Linux作為NAT呢？因為Linux NAT還可以額外的加裝很多分析軟體， 可以用來分析用戶端的連線，或者是用來控制頻寬與流量，達到更公平的頻寬使用呢！ 更多的功能則有待後續更多的學習囉！你也可以參考我們在伺服器架設篇當中的資料囉！

SAMBA(加入Windows網路上的芳鄰)：
在你的Windows系統之間如何傳輸資料呢？當然就是透過網路上的芳鄰來傳輸啦！那還用問。 這也是學校老師在上課過程中要分享資料給同學常用的機制了。問題是，Windows 7 的網芳一般只能同時分享十部用戶端連線，超過的話就得要等待了～真不人性化。

我們可以使用Linux上面的SAMBA這個軟體來達成加入Windows網芳的功能喔！SAMBA的效能不錯， 也沒有用戶端連線數的限制，相當適合於一般學校環境的檔案伺服器(file server)的角色呢！

這種伺服器由於分享的資料量較大，對於系統的網路卡與硬碟的大小及速度就比較重要， 如果你還針對不同的使用者提供檔案伺服器功能，那麼/home這個目錄可以考慮獨立出來，並且加大容量。

Mail(郵件伺服器)：
郵件伺服器是非常重要的，尤其對於現代人來說，電子郵件幾乎已經取代了傳統的人工郵件遞送了。 拜硬碟價格大跌及Google/Yahoo/MicroSoft公平競爭之賜，一般免費的email信箱幾乎都提供了很不錯的郵件服務， 包過Web介面的傳輸、大於2GB以上的容量空間及全年無休的服務等等。例如非常多人使用的gmail就是一例： http://gmail.com。

雖然免費的信箱已經非常夠用了，老實說，鳥哥也不建議您架設mail server了。問題是， 如果你是一間私人單位的公司，你的公司內傳送的email是具有商業機密或隱私性的，那你還想要交給免費信箱去管理嗎？ 此時才有需要架設mail server囉。在mail server上面，重要的也是硬碟容量與網路卡速度，在此情境中，也可以將/var目錄獨立出來，並加大容量。

Web(WWW伺服器)：
WWW伺服器幾乎是所有的網路主機都會安裝的一個功能，因為他除了可以提供Internet的WWW連線之外， 很多在網路主機上面的軟體功能(例如某些分析軟體所提供的最終分析結果的畫面)也都使用WWW作為顯示的介面， 所以這傢伙真是重要到不行的。

CentOS使用的是Apache這套軟體來達成WWW網站的功能，在WWW伺服器上面，如果你還有提供資料庫系統的話， 那麼CPU的等級就不能太低，而最重要的則是RAM了！要增加WWW伺服器的效能，通常提升RAM是一個不錯的考量。

DHCP(提供用戶端自動取得IP的功能)：
如果你是個區域網路管理員，你的區網內共有20部以上的電腦給一般員工使用，這些員工假設並沒有電腦網路的維護技能。 那你想要讓這些電腦在連上Internet時需要手動去設定IP還是他可以自動的取得IP呢？當然是自動取得比較方便啦！ 這就是DHCP服務的功能了！用戶端電腦只要選擇『自動取得IP』，其他的，就是你系統管理員在DHCP伺服器上面設定一下即可。 這個咚咚的硬體要求可以不必很高囉。

FTP：
常常看到很多朋友喜歡架設FTP去進行網路資料的傳輸，甚至很多人會架設地下FTP網站去傳輸些違法的資料。 老實說，『FTP傳輸再怎麼地下化也是很容易被捉到的』啦！所以，鳥哥相當不建議您架設FTP的喔！ 不過，對於大專院校來說，因為常常需要分享給全校師生一些免費的資源， 此時匿名使用者的FTP軟體功能就很需要存在了。對於FTP的硬體需求來說，硬碟容量與網路卡好壞相關性較高。

大致上我們會安裝的伺服器軟體就是這一些囉！ 當然啦，還是那句老話，在目前你剛接觸Linux的這個階段中，還是以Linux基礎為主， 鳥哥也希望你先瞭解Linux的相關主機操作技巧，其他的架站，未來再談吧！ 而上面列出的各項服務，僅是提供給你，如果想要架設某種網路服務的主機時，你應該如何規劃主機比較好！

主機硬碟的主要規劃
最簡單的分割方法：
這個在上面第二節已經談過了，就是僅分割出根目錄與記憶體置換空間( / & swap )即可。 然後再預留一些剩餘的磁碟以供後續的練習之用。不過，這當然是不保險的分割方法(所以鳥哥常常說這是『懶人分割法』)！ 因為如果任何一個小細節壞掉(例如壞軌的產生)，你的根目錄將可能整個的損毀～挽救方面較困難！

稍微麻煩一點的方式：
較麻煩一點的分割方式就是先分析這部主機的未來用途，然後根據用途去分析需要較大容量的目錄， 以及讀寫較為頻繁的目錄，將這些重要的目錄分別獨立出來而不與根目錄放在一起， 那當這些讀寫較頻繁的磁碟分割槽有問題時，至少不會影響到根目錄的系統資料，那挽救方面就比較容易啊！ 在預設的CentOS環境中，底下的目錄是比較符合容量大且(或)讀寫頻繁的目錄囉：
/boot
/
/home
/var
Swap
以鳥哥為例，通常我會希望我的郵件主機大一些，因此我的/var通常會給個數GB的大小， 如此一來就可以不擔心會有郵件空間不足的情況了！另外，由於我開放SAMBA服務， 因此提供每個研究室內人員的資料備份空間，所以囉，/home所開放的空間也很大！至於/usr/的容量，大概只要給2-5GB即可！凡此種種均與您當初預計的主機服務有關！

鳥哥的兩個實際案例
案例一：家用的小型Linux伺服器，IP分享與檔案分享中心：
提供服務：
提供家裡的多部電腦的網路連線分享，所以需要NAT功能。提供家庭成員的資料存放容量，由於家裡使用Windows系統的成員不少， 所以建置SAMBA伺服器，提供網芳的網路磁碟功能。

主機硬體配備：
CPU使用 AMD Athlon 4850e 省電型 CPU
記憶體大小為 4GB
兩張網路卡，控制晶片為常見的螃蟹卡(Realtek)
只有一顆 640GB 的磁碟
顯示卡為 CPU 內的內建顯卡 (Radeon HD 3200)
安裝完畢後將螢幕,鍵盤,滑鼠,DVD-ROM等配備均移除，僅剩下網路線與電源線。

硬碟分割：
分成 /, /usr, /var, /tmp等目錄均獨立；
1 GB的Swap；
安裝比較過時的 CentOS 5.x 最新版

案例二：提供Linux的PC叢集(Cluster)電腦群：
提供服務：
提供研究室成員對於模式模擬的軟、硬體平台，主要提供的服務並非網際網路服務，而是研究室內部的研究工作分析。

主機硬體配備：
利用兩部多核系統處理器 (一部 20核 40緒，一部 12核 24緒)，搭配 10G 網卡組合而成
使用內建的顯示卡
運算用主機僅一顆磁碟，儲存用主機提供 8 顆 2TB 磁碟組成的磁碟陣列
一部 128GB 記憶體，一部 96GB 記憶體

硬碟分割：
運算主機方面，整顆磁碟僅分 /boot, / 及 swap 而已
儲存主機方面，磁碟陣列分成兩顆磁碟，一顆 100G 給系統用，一顆 12T 給資料用。系統磁碟用的分割為 /boot, /, /home, /tmp, /var 等分割， 資料磁碟全部容量規劃在同一個分割槽而已。
安裝最新的 CentOS 7.x 版
在上面的案例中，案例一是屬於小規模的主機系統，因此只要使用預計被淘汰的配備即可進行主機的架設！ 唯一可能需要購買的大概是網路卡吧！呵呵！而在案例二中，由於我需要大量的數值運算， 且運算結果的資料非常的龐大，因此就需要比較大的磁碟容量與較佳的網路系統了。 以上的資料請先記得，因為下一章節在實際安裝Linux之前，你得先進行主機的規劃呀！